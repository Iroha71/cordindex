(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{224:function(t,e,n){"use strict";n.r(e);var r={layout:"desc"},_=n(25),component=Object(_.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col-sm-12 col-md-12 col-lg-10 parent"},[n("div",{staticClass:"content"},[n("h1",[t._v("DEVISE(Railsユーザ認証Gem)")]),t._v(" "),n("p",{staticClass:"bold"},[t._v("メール認証する場合 => "),n("nuxt-link",{attrs:{to:"/ruby/mail"}},[t._v("メール設定")])],1),t._v(" "),n("h2",[t._v("インストール")]),t._v(" "),n("code",[t._v("Gemfile")]),t._m(0),t._v(" "),t._m(1),t._v(" "),n("h2",[t._v("モデル作成")]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),n("p",[t._v("4.生成されたマイグレーションファイルでユーザのカラムを編集")]),t._v(" "),n("h2",[t._v("コントローラ作成")]),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),n("code",[t._v("mount_devise_token_auth_for 'User', at: 'auth', controller: { registrations: 'auth/registrations' }")]),t._v(" "),t._m(13),t._v(" "),n("h2",[t._v("メール認証用コントローラ作成")]),t._v(" "),t._m(14),t._v(" "),t._m(15)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",[this._v(" ->追記したら"),e("span",{staticClass:"bold"},[this._v("bundle install")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[this._v("\r\n            "),e("code",[this._v("\r\n    gem 'devise'\r\n    gem 'devise_token_auth'\r\n            ")]),this._v("\r\n        ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("1."),e("span",{staticClass:"bold"},[this._v("rails g devise:install")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("devise本体のインストール")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("2."),e("span",{staticClass:"bold"},[this._v("rails g devise_token_auth:install User auth")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("devise_token_authインストール(クラス名とパスを指定")]),this._v(" "),e("ul",[e("li",[this._v("認証パス＝URLのエンドポイント名")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("3."),e("code",[this._v("user.rb")]),this._v("から"),e("code",[this._v(":trackableを削除")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("メール認証する場合は"),e("code",[this._v(":confirmable")]),this._v("を追加")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("4."),e("code",[this._v("devise_token_auth.rb")]),this._v("のコメントを解除")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("config.change_headers_on_each_request (=>リクエストごとに認証情報を変更するか?)")]),this._v(" "),e("li",[this._v("config.headers.names (=>ヘッダに付与する認証情報)")]),this._v(" "),e("li",[this._v("config.token_lifespan (=>トークンのリフレッシュ間隔)")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("1."),e("span",{staticClass:"bold"},[this._v("rails g controller auth/registrations")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[this._v("\r\n            "),e("code",[this._v("\r\n    class RegistrationsController < DeviseTokenAuth::RegistrationsController #継承先をApplicationControllerから変更\r\n        def sign_up_params\r\n            params.permit(:name, :email)\r\n        end\r\n\r\n        def account_update_params\r\n            params.permit(:name, :email)\r\n        end\r\n    end\r\n            ")]),this._v("\r\n        ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("2."),e("code",[this._v("routes.rb")]),this._v("にマウント")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("code",[this._v("at:")]),this._v("を変更することでパスを変更可能")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("1."),e("span",{staticClass:"bold"},[this._v("rails g controller devise_token_auth/confirmations")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[this._v("\r\n             "),e("code",[this._v("\r\n    module DeviseTokenAuth\r\n      class ConfirmationsController < DeviseTokenAuth::ApplicationController #継承先をApplicationControllerから変更\r\n          def show\r\n              @resource = resource_class.confirm_by_token(params[:confirmation_token])\r\n                \r\n              if @resource.errors.empty?\r\n                  redirect_to(ENV.fetch(\"CONFIRM_REDIRECT_URL\")) #メール認証後のリダイレクト先を指定\r\n              else\r\n                  raise ActionController::RoutingError, 'Not Found'\r\n              end\r\n          end\r\n      end\r\n    end\r\n             ")]),this._v("\r\n         ")])}],!1,null,null,null);e.default=component.exports}}]);